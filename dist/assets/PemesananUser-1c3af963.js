import{a as m}from"./axios-8e4517c3.js";import{S as d}from"./sweetalert2-50e64164.js";import{_ as k,h as u,o,c as r,l as P,a,g as b,m as C,n as _,k as c,F as g,i as h,t as l,b as f,v,j as B}from"./index-a4dfc1b9.js";import{N as E,F as T}from"./Footer-49148f48.js";const I={},F={class:"nav-item"};function N(n,e){const p=u("router-link");return o(),r("ul",{class:_(["navbar-nav bg-light sidebar sidebar-dark accordion",{toggled:n.sidebarToggled}]),id:"accordionSidebar"},[e[1]||(e[1]=P('<a class="sidebar-brand d-flex align-items-center justify-content-center" href="#"><div class="sidebar-brand-icon mt-2"></div><div class="sidebar-brand-text ms-3"><span class="text-primary">Rental PS</span></div></a><div class="sidebar-heading mt-5 text-primary">Menu</div>',2)),a("li",F,[b(p,{class:"nav-link text-primary",to:"/pemesanan-ps","active-class":"font-weight-bold text-primary active-link"},{default:C(()=>e[0]||(e[0]=[a("i",{class:"bi bi-journal-text text-primary fw-bold"},null,-1),a("span",null,"Pemesanan",-1)])),_:1})]),e[2]||(e[2]=a("hr",{class:"sidebar-divider d-none d-md-block"},null,-1))],2)}const A=k(I,[["render",N]]);const j={name:"PemesananManagement",components:{Sidebar:A,Navbar:E,Footer:T},data(){return{pemesananList:[],availableMenu:[],form:{id:"",tanggal_sewa:"",durasi:1,menu_id:""},isEdit:!1,modalInstance:null}},methods:{async fetchPemesanan(){try{const n=await m.get("https://apirental.keuanganfpti.com/api/pemesanan/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.pemesananList=n.data.data}catch(n){console.error("Error fetching pemesanan:",n)}},async fetchAvailableMenu(){if(this.form.tanggal_sewa)try{const n=await m.post("https://apirental.keuanganfpti.com/api/menu/available",{tanggal:this.form.tanggal_sewa},{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.availableMenu=n.data}catch(n){console.error("Error fetching available menu:",n)}},async submitForm(){const n=this.isEdit?"/pemesanan/update":"/pemesanan/create";try{const e=await m.post(`https://apirental.keuanganfpti.com/api${n}`,this.form,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});e.data&&e.data.data&&e.data.data.redirect_url?window.location.href=e.data.data.redirect_url:(d.fire("Success!",this.isEdit?"Pemesanan diperbarui!":"Pemesanan ditambahkan!","success"),this.hideModal(),this.fetchPemesanan())}catch{d.fire("Error!","Terjadi kesalahan dalam proses.","error")}},async deletePemesanan(n){if((await d.fire({title:"Yakin ingin menghapus?",icon:"warning",showCancelButton:!0,confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed)try{await m.delete(`https://apirental.keuanganfpti.com/api/pemesanan/delete/${n}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}}),d.fire("Berhasil!","Pemesanan berhasil dihapus.","success"),this.fetchPemesanan()}catch{d.fire("Error!","Gagal menghapus pemesanan.","error")}},openModal(n,e=null){this.isEdit=n==="update",this.form=e?{...e}:{id:"",tanggal_sewa:"",durasi:1,menu_id:"",user_id:""},this.modalInstance=new bootstrap.Modal(this.$refs.pemesananModalRef),this.modalInstance.show()},hideModal(){this.modalInstance&&this.modalInstance.hide()}},created(){this.fetchPemesanan()}},U={id:"wrapper"},V={id:"content-wrapper",class:"d-flex flex-column"},z={id:"content"},R={class:"container-fluid mt-4"},D={class:"table"},L=["onClick"],H=["onClick"],q={class:"modal fade",id:"pemesananModal",tabindex:"-1","aria-labelledby":"pemesananModalLabel","aria-hidden":"true",ref:"pemesananModalRef"},G={class:"modal-dialog modal-lg modal-dialog-centered"},Y={class:"modal-content"},J={class:"modal-header"},K={class:"modal-title"},O={class:"modal-body"},Q=["value"],W={class:"modal-footer"};function X(n,e,p,Z,i,s){const y=u("Sidebar"),w=u("Navbar"),M=u("Footer");return o(),r("div",U,[b(y,{class:_(n.sidebarClass)},null,8,["class"]),a("div",V,[a("div",z,[b(w,{onToggleSidebar:n.toggleSidebar},null,8,["onToggleSidebar"]),a("div",R,[e[12]||(e[12]=a("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Manajemen Pemesanan",-1)),a("button",{class:"btn btn-primary mb-3",onClick:e[0]||(e[0]=t=>s.openModal("create"))},e[8]||(e[8]=[a("i",{class:"bi bi-plus-lg"},null,-1),c(" Pemesanan ")])),a("table",D,[e[11]||(e[11]=a("thead",null,[a("tr",null,[a("th",null,"No"),a("th",null,"Tanggal Sewa"),a("th",null,"Durasi"),a("th",null,"Menu"),a("th",null,"Status"),a("th",null,"Actions")])],-1)),a("tbody",null,[(o(!0),r(g,null,h(i.pemesananList,(t,S)=>(o(),r("tr",{key:t.id},[a("td",null,l(S+1),1),a("td",null,l(t.tanggal_sewa),1),a("td",null,l(t.durasi),1),a("td",null,l(t.menu.name),1),a("td",null,l(t.payment.status),1),a("td",null,[a("button",{class:"btn btn-warning btn-sm me-2",onClick:x=>s.openModal("update",t)},e[9]||(e[9]=[a("i",{class:"bi bi-pencil-square"},null,-1),c(" Edit ")]),8,L),a("button",{class:"btn btn-danger btn-sm",onClick:x=>s.deletePemesanan(t.id)},e[10]||(e[10]=[a("i",{class:"bi bi-trash3-fill"},null,-1),c(" Hapus ")]),8,H)])]))),128))])])]),b(M)])]),a("div",q,[a("div",G,[a("div",Y,[a("div",J,[a("h5",K,l(i.isEdit?"Update Pemesanan":"Tambah Pemesanan"),1),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:e[1]||(e[1]=(...t)=>s.hideModal&&s.hideModal(...t))},e[13]||(e[13]=[a("span",{"aria-hidden":"true"},"Ã—",-1)]))]),a("div",O,[e[15]||(e[15]=a("label",{for:"tanggal_sewa"},"Tanggal Sewa",-1)),f(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>i.form.tanggal_sewa=t),type:"date",class:"form-control mb-3",onChange:e[3]||(e[3]=(...t)=>s.fetchAvailableMenu&&s.fetchAvailableMenu(...t))},null,544),[[v,i.form.tanggal_sewa]]),e[16]||(e[16]=a("i",{style:{color:"red","font-size":"10px"}},"* khusus weekend akan dikenakan biaya tambahan Rp. 50.000",-1)),e[17]||(e[17]=a("br",null,null,-1)),e[18]||(e[18]=a("label",{for:"durasi"},"Durasi (hari)",-1)),f(a("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>i.form.durasi=t),type:"number",class:"form-control mb-3",placeholder:"Durasi"},null,512),[[v,i.form.durasi,void 0,{number:!0}]]),e[19]||(e[19]=a("label",{for:"menu_id"},"Menu Sewa",-1)),f(a("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>i.form.menu_id=t),class:"form-control mb-3"},[e[14]||(e[14]=a("option",{value:""},"Pilih Menu",-1)),(o(!0),r(g,null,h(i.availableMenu,t=>(o(),r("option",{key:t.id,value:t.id},l(t.name)+" - "+l(t.jenis)+" - "+l(t.jenis==="PS 4"?"Rp. 30.000 / sesi":"Rp. 40.000 / sesi"),9,Q))),128))],512),[[B,i.form.menu_id]])]),a("div",W,[a("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=(...t)=>s.hideModal&&s.hideModal(...t))}," Batal "),a("button",{type:"button",class:"btn btn-primary",onClick:e[7]||(e[7]=(...t)=>s.submitForm&&s.submitForm(...t))},l(i.isEdit?"Update":"Tambah"),1)])])])],512)])}const ne=k(j,[["render",X],["__scopeId","data-v-8ffb1d42"]]);export{ne as default};
